fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQJ7PS8pvnCKdpLgJFonsZNN54Rs8oTpzGgCxhbfZzd3KmKb9k12OEwgAWuDAHiIPraWKxoS5TlCm4X/pub?gid=0&single=true&output=csv").then(a=>a.text()).then(a=>{let l=a.trim().split("\n");if(l.length>0){let r=l[0].split(",")[0].replace(",",".");document.getElementById("dolarValor").textContent=r||"N/A"}else document.getElementById("dolarValor").textContent="Sin datos"}).catch(a=>{document.getElementById("dolarValor").textContent="Error",console.error("Error al obtener d\xf3lar:",a)});const e=new Intl.DateTimeFormat("es-AR").format(new Date);document.getElementById("fechaActual").textContent=e,window.onload=function(){document.getElementById("logo-desktop").src="images/logo-miphone-1.svg?refresh="+(new Date).getTime()};const t=document.querySelector(".loader-local");t.classList.remove("loader-local-hidden"),Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vRr62BlKCzICpC0ctnU2mRB8cq_SOCcsgydXQJXD5pQvasO1b1iT0Wp_L7sFxH8UGJCepaMjng1GUO0/pub?gid=1610793698&single=true&output=csv",{download:!0,complete:function(a){(function(a){let l=document.getElementById("categoriasContainer"),r=document.getElementById("plantilla-categoria");l.innerHTML="",a.forEach((a,s)=>{let i=`cat-${s}`,d=a.headers.indexOf("Ocultar"),c=(a.headers.indexOf("Detalles"),a.headers.indexOf("Fotos")),p=a.headers.indexOf("Specs"),u=a.headers.findIndex((a,l)=>l!==d),b=r.content.cloneNode(!0),m=(b.querySelector(".accordion"),b.querySelector(".accordion-button")),h=b.querySelector(".accordion-collapse"),g=n[a.nombre]||"bi bi-phone",f=`collapse-${i}`,C=`heading-${i}`;m.setAttribute("data-bs-target",`#${f}`),m.setAttribute("aria-controls",f),h.id=f,h.setAttribute("aria-labelledby",C),m.closest("h2").id=C,b.querySelector(".icono-categoria").className=`me-2 icono-categoria ${g}`,b.querySelector(".nombre-categoria").textContent=a.nombre,b.querySelector(".alerta-categoria").innerHTML=function(a){let l={"MACBOOK AIR":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi\xe9n traemos iMac, Mac mini, Mac Studio","MACBOOK PRO":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi\xe9n traemos iMac, Mac mini, Mac Studio",IPHONE:"\xa1Combo cargador original (Apple 20W, MWVV3AM) + U$30!",SAMSUNG:"Por otros productos de la marca (Linea Z, Samsung Tab, etc) consultanos por WhatsApp",ACCESORIOS:"Consultar disponibilidad en modelos y colores"};return l[a]?`
    <div class="alert alert-info d-flex justify-content-center align-items-center text-center mb-3 py-2 px-3" role="alert">
      <i class="bi bi-info-circle-fill me-2"></i>
      <div class="small">${l[a]}</div>
    </div>
  `:""}(a.nombre);let y=b.querySelector(".encabezados");a.headers.forEach((a,l)=>{if(l!==d){let r=document.createElement("th");r.textContent=a,y.appendChild(r)}});let A=b.querySelector(".filas-productos"),E=null;a.productos.filter(a=>-1===d||"x"!==a[d].toLowerCase()).forEach(l=>{let r=l.every(a=>""===a),s=document.createElement("tr");if(r){let i=document.createElement("td");i.colSpan=a.headers.length-(-1!==d?1:0),i.innerHTML="&nbsp;",s.appendChild(i)}else l.forEach((l,r)=>{if(r===d)return;let i=document.createElement("td");if(r===u){let b=l&&l!==E;return E=l||E,b?(i.textContent=l,i.classList.add("fusion-celda")):i.innerHTML=`<span class="visually-hidden">${l}</span>`,void s.appendChild(i)}if("L"===a.headers[r]&&l)return i.innerHTML=o[l]||l,void s.appendChild(i);if(r===c&&l){let m=document.createElement("button");return m.className="btn btn-secondary btn-sm",m.innerHTML='<i class="bi bi-image"></i>',m.title="Ver fotos",m.setAttribute("data-bs-toggle","modal"),m.setAttribute("data-bs-target","#modalFotos"),m.setAttribute("data-fotos",l),m.addEventListener("click",()=>{let a=l.split(",").map(a=>a.trim()).filter(Boolean),r=document.querySelector("#carouselFotos .carousel-inner");r.innerHTML="",a.forEach((a,l)=>{let s=document.createElement("div");s.className="carousel-item"+(0===l?" active":""),s.innerHTML=`<img src="${a}" class="d-block w-75 mx-auto" alt="Foto ${l+1}">`,r.appendChild(s)})}),i.appendChild(m),void s.appendChild(i)}if(r===p&&l){let h=document.createElement("a");return h.className="btn btn-link btn-sm",h.textContent="Ver ficha",h.href=l,h.target="_blank",h.rel="noopener noreferrer",i.appendChild(h),void s.appendChild(i)}i.innerHTML=l||"&nbsp;",s.appendChild(i)});A.appendChild(s)}),l.appendChild(b)})})(function(a){let l=[],r=null,s=[],i=[],d=!1;for(let c=0;c<a.length;c++){let p=a[c].map(a=>(a||"").trim()),u=p.filter(a=>""!==a);1!==u.length||u[0]!==u[0].toUpperCase()?d?(s=p,d=!1):s.length>0&&i.push(p):(r&&s.length>0&&l.push({nombre:r,headers:s,productos:i}),r=u[0],s=[],i=[],d=!0)}return r&&s.length>0&&l.push({nombre:r,headers:s,productos:i}),l}(a.data)),t.classList.add("loader-local-hidden")}});const n={IPHONE:"bi-apple",AIRPODS:"bi-earbuds","APPLE WATCH":"bi-smartwatch",AIRTAG:"bi-tag",IPAD:"bi-tablet-fill","MACBOOK AIR":"bi-laptop","MACBOOK PRO":"bi-laptop",PLAYSTATION:"bi-playstation",XBOX:"bi-xbox","NINTENDO SWITCH":"bi-nintendo-switch",VR:"bi-headset-vr",GOPRO:"bi-camera-video",INSTA360:"bi-camera-video",SMARTWATCH:"bi-watch",ACCESORIOS:"bi-bag-plus","DRONE DJI":"bi-robot"},o={NEW:'<span class="badge bg-warning text-dark">✈️\xa1NUEVO!</span>',SALE:'<span class="badge bg-danger">\uD83D\uDD25\xa1OFERTA!</span>',HOT:'<span class="badge bg-primary">\uD83D\uDD25 HOT</span>',LIMITED:'<span class="badge bg-info text-dark">⏳ LIMITADO</span>'};document.getElementById("searchGeneral").addEventListener("input",function(a,l){let r;return(...l)=>{clearTimeout(r),r=setTimeout(()=>a.apply(this,l),300)}}(()=>{let a=document.getElementById("searchGeneral").value.toLowerCase().trim(),l=a?a.split(/\s+/):[],r=document.getElementById("resultadoBusqueda"),s=0;document.querySelectorAll(".accordion-flush").forEach(r=>{let i=r.querySelector(".accordion-button"),d=r.querySelector(".collapse"),c=bootstrap.Collapse.getOrCreateInstance(d,{toggle:!1});if(!a)return r.style.display="",c.hide(),i.classList.add("collapsed"),i.setAttribute("aria-expanded","false"),void r.querySelectorAll("tbody tr").forEach(a=>{a.style.display=""});let p=i.innerText.toLowerCase(),u=Array.from(r.querySelectorAll("tbody tr")),b=!1;u.forEach(a=>{let r=Array.from(a.cells).filter((a,l)=>2!==l).map(a=>a.innerText).join(" ").toLowerCase()+" "+p;if(a.innerText.trim()){let i=l.every(a=>r.includes(a));a.style.display=i?"":"none",i&&(b=!0,s++)}else a.style.display="none"}),b?(r.style.display="",c.show(),i.classList.remove("collapsed"),i.setAttribute("aria-expanded","true")):(c.hide(),i.classList.add("collapsed"),i.setAttribute("aria-expanded","false"),r.style.display="none")}),a?0===s?(r.innerHTML='<span class="badge bg-danger">Sin resultados. Consultar existencia por WhatsApp</span>',r.classList.add("no-resultado"),r.classList.remove("resultado-encontrado")):(r.innerHTML=`<span class="badge bg-success">${s} resultado${1!==s?"s":""} encontrado${1!==s?"s":""}</span>`,r.classList.add("resultado-encontrado"),r.classList.remove("no-resultado")):(r.innerHTML="",r.classList.remove("no-resultado","resultado-encontrado"))},300)),document.getElementById("clearSearch").addEventListener("click",function(){let a=document.getElementById("searchGeneral");a.value="",a.dispatchEvent(new Event("input"))}),window.buscarMarca=function(a){let l=document.getElementById("searchGeneral");l.value=a,l.dispatchEvent(new Event("input"))},document.getElementById("faqModal").addEventListener("hidden.bs.modal",()=>{document.querySelectorAll("#faqModal .accordion-collapse.show").forEach(a=>{new bootstrap.Collapse(a,{toggle:!1}).hide()})});
