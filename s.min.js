const csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vRr62BlKCzICpC0ctnU2mRB8cq_SOCcsgydXQJXD5pQvasO1b1iT0Wp_L7sFxH8UGJCepaMjng1GUO0/pub?gid=1610793698&single=true&output=csv",cotizacionUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vQJ7PS8pvnCKdpLgJFonsZNN54Rs8oTpzGgCxhbfZzd3KmKb9k12OEwgAWuDAHiIPraWKxoS5TlCm4X/pub?gid=0&single=true&output=csv";fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQJ7PS8pvnCKdpLgJFonsZNN54Rs8oTpzGgCxhbfZzd3KmKb9k12OEwgAWuDAHiIPraWKxoS5TlCm4X/pub?gid=0&single=true&output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split("\n")[0]?.split(",")[0]?.replace(",",".")||"N/A";document.getElementById("dolarValor").textContent=t}).catch(()=>{document.getElementById("dolarValor").textContent="Error"}),document.getElementById("fechaActual").textContent=new Intl.DateTimeFormat("es-AR").format(new Date),window.addEventListener("load",()=>{let e=document.getElementById("logo-desktop");e&&(e.src+=`?v=${Date.now()}`)});const loader=document.querySelector(".loader-local");function procesarCategorias(e){let t=[],a=null,r=[],l=[],o=!1;return e.forEach(e=>{let n=e.map(e=>(e||"").trim()),s=n.filter(Boolean);if(1===s.length&&s[0]===s[0].toUpperCase()){a&&r.length&&t.push({nombre:a,headers:r,productos:l}),a=s[0],r=[],l=[],o=!0;return}if(o){r=n,o=!1;return}r.length&&l.push(n)}),a&&r.length&&t.push({nombre:a,headers:r,productos:l}),t}function crearBadgeEl(e){let t=document.createElement("span");return t.innerHTML=badges[e]||"",t}function crearBotonFotos(e){let t=document.createElement("button");return t.className="btn btn-link btn-sm ms-2 p-0",t.textContent="Ver fotos",t.setAttribute("data-bs-toggle","modal"),t.setAttribute("data-bs-target","#modalFotos"),t.setAttribute("data-fotos",e),t.addEventListener("click",()=>{let t=e.split(",").map(e=>e.trim()).filter(Boolean),a=document.querySelector("#carouselFotos .carousel-inner");a.innerHTML="",t.forEach((e,t)=>{let r=document.createElement("div");r.className="carousel-item"+(0===t?" active":""),r.innerHTML=`<img src="${e}" class="d-block w-75 mx-auto" alt="Foto ${t+1}">`,a.appendChild(r)})}),t}function crearMensajeWhatsApp(e,t,a=""){let r=`\xa1Hola! Vi el ${t}${a?" "+a:""} en la categor\xeda ${e} de la web y me gustar\xeda saber si est\xe1 disponible.`;return`https://wa.me/5491127737463?text=${encodeURIComponent(r)}`}function renderCategorias(e){let t=document.getElementById("categoriasContainer"),a=document.getElementById("plantilla-categoria");t.innerHTML="",e.forEach((e,r)=>{let{nombre:l,headers:o,productos:n}=e,s="ACCESORIOS"===l,i=e=>o.indexOf(e),c=s?i("Producto"):0,d=s?i("Informaci\xf3n"):1,p=i("Precio"),u=i("Fotos"),m=i("L"),g=i("Specs"),C=i("Ocultar"),b=a.content.cloneNode(!0),h=b.querySelector(".accordion-button"),E=b.querySelector(".accordion-collapse"),v=`collapse-cat-${r}`;h.setAttribute("data-bs-target",`#${v}`),h.setAttribute("aria-controls",v),E.id=v,b.querySelector(".icono-categoria").className=`me-2 icono-categoria ${iconosCategorias[l]||"bi bi-phone"}`,b.querySelector(".nombre-categoria").textContent=l,b.querySelector(".alerta-categoria").innerHTML=renderAlerta(l);let A=document.createElement("div");if(A.className="lista-productos",s)n.forEach(e=>{if(-1!==C&&"x"===e[C]?.toLowerCase())return;let t=e[c]?.trim(),a=e[d]?.trim(),r=e[p]?.trim(),o=e[u]?.trim(),n=e[m]?.trim();if(!t&&!a&&!r)return;let s=document.createElement("div");s.className="grupo-modelo tarjeta-producto";let i=document.createElement("div");i.className="titulo-modelo",i.textContent=t,o&&i.appendChild(crearBotonFotos(o)),s.appendChild(i);let g=document.createElement("div");g.className="variante primera-variante";let b=document.createElement("div");b.className="detalle",b.textContent=a;let h=document.createElement("div");h.className="precio-badge",n&&badges[n]&&h.appendChild(crearBadgeEl(n));let E=document.createElement("div");E.textContent=r||"Consultar",h.appendChild(E),g.appendChild(b),g.appendChild(h),s.appendChild(g),A.appendChild(s),g.style.cursor="pointer",g.addEventListener("click",()=>window.open(crearMensajeWhatsApp(l,t),"_blank"))});else{let f="",y,S=!0;n.forEach(e=>{if(-1!==C&&"x"===e[C]?.toLowerCase())return;let t=e[c]?.trim(),a=e[d]?.trim(),r=e[p]?.trim(),o=e[g]?.trim(),n=e[m]?.trim();if(!t)return;if(t!==f){f=t,S=!0,(y=document.createElement("div")).className="grupo-modelo tarjeta-producto";let s=document.createElement("div");s.className="titulo-modelo";let i=document.createElement("span");if(i.textContent=t,s.appendChild(i),o){let u=document.createElement("a");u.href=o,u.textContent="Ver ficha",u.target="_blank",u.rel="noopener noreferrer",u.className="btn btn-link btn-sm p-0 ms-auto",s.appendChild(u)}y.appendChild(s),A.appendChild(y)}let b=document.createElement("div");b.className="variante"+(S?" primera-variante":""),S=!1;let h=document.createElement("div");h.className="detalle",h.textContent=a;let E=document.createElement("div");E.className="precio-badge",n&&badges[n]&&E.appendChild(crearBadgeEl(n));let v=document.createElement("div");v.textContent=r||"Consultar",E.appendChild(v),b.appendChild(h),b.appendChild(E),y.appendChild(b),b.style.cursor="pointer",b.addEventListener("click",()=>window.open(crearMensajeWhatsApp(l,t,a),"_blank"))})}E.querySelector(".accordion-body").appendChild(A),t.appendChild(b)})}function renderAlerta(e){let t={"MACBOOK AIR":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi\xe9n traemos iMac, Mac mini, Mac Studio","MACBOOK PRO":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi\xe9n traemos iMac, Mac mini, Mac Studio",IPHONE:"\xa1Con la compra de un iPhone + U$30 te llevas un cargador 20W Apple ORIGINAL!",SAMSUNG:"Por otros productos de la marca (Linea Z, Samsung Tab, etc) consultanos por WhatsApp",ACCESORIOS:"Consultar disponibilidad en modelos y colores"};return t[e]?`<div class="alert alert-info d-flex justify-content-center align-items-center text-center mb-3 py-2 px-3" role="alert">
    <i class="bi bi-info-circle-fill me-2"></i>
    <div class="small">${t[e]}</div>
  </div>`:""}loader?.classList.remove("loader-local-hidden"),Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vRr62BlKCzICpC0ctnU2mRB8cq_SOCcsgydXQJXD5pQvasO1b1iT0Wp_L7sFxH8UGJCepaMjng1GUO0/pub?gid=1610793698&single=true&output=csv",{download:!0,complete({data:e}){let t=procesarCategorias(e);renderCategorias(t),loader?.classList.add("loader-local-hidden")}});const iconosCategorias={IPHONE:"bi-apple",AIRPODS:"bi-earbuds","APPLE WATCH":"bi-smartwatch",AIRTAG:"bi-tag",IPAD:"bi-tablet-fill","MACBOOK AIR":"bi-laptop","MACBOOK PRO":"bi-laptop",PLAYSTATION:"bi-playstation",XBOX:"bi-xbox","NINTENDO SWITCH":"bi-nintendo-switch",VR:"bi-headset-vr",GOPRO:"bi-camera-video",INSTA360:"bi-camera-video",SMARTWATCH:"bi-watch",ACCESORIOS:"bi-bag-plus","DRONE DJI":"bi-robot"},badges={NEW:`<span class="badge bg-warning text-dark">‚úàÔ∏è\xa1NUEVO!</span>`,SALE:`<span class="badge bg-danger">üî•\xa1OFERTA!</span>`,HOT:`<span class="badge bg-primary">üî• HOT</span>`,LIMITED:`<span class="badge bg-info text-dark">‚è≥ LIMITADO</span>`};function filtrarGeneral(){let e=document.getElementById("searchGeneral").value.toLowerCase().trim(),t=e.split(/\s+/),a=document.getElementById("resultadoBusqueda"),r=0;document.querySelectorAll(".accordion-flush").forEach(a=>{let l=a.querySelector(".accordion-button"),o=a.querySelector(".collapse"),n=bootstrap.Collapse.getOrCreateInstance(o,{toggle:!1}),s=l?.textContent?.toLowerCase()||"",i=Array.from(a.querySelectorAll(".grupo-modelo")),c=!1;if(i.forEach(e=>{let a=e.querySelector(".titulo-modelo"),l=a?.childNodes[0]?.textContent?.toLowerCase().trim()||"",o=e.querySelectorAll(".variante"),n=!1;o.forEach(e=>{let a=e.querySelector(".detalle")?.textContent?.toLowerCase()||"",o=e.querySelector(".badge")?.textContent?.toLowerCase()||"",i=`${s} ${l} ${a} ${o}`,c=t.every(e=>i.includes(e));e.style.display=c?"":"none",c&&(n=!0,r++)}),e.style.display=n?"":"none",n&&(c=!0)}),!e){a.style.display="",n.hide(),l.classList.add("collapsed"),i.forEach(e=>e.querySelectorAll(".variante").forEach(e=>e.style.display=""));return}c?(a.style.display="",n.show(),l.classList.remove("collapsed")):(a.style.display="none",n.hide(),l.classList.add("collapsed"))}),e?0===r?(a.innerHTML='<span class="badge bg-danger">Sin resultados. Consultar existencia por WhatsApp</span>',a.classList.add("no-resultado"),a.classList.remove("resultado-encontrado")):(a.innerHTML=`<span class="badge bg-success">${r} resultado${1!==r?"s":""} encontrado${1!==r?"s":""}</span>`,a.classList.add("resultado-encontrado"),a.classList.remove("no-resultado")):(a.textContent="",a.classList.remove("no-resultado","resultado-encontrado"))}function buscarMarca(e){let t=document.getElementById("searchGeneral");t.value=e,t.dispatchEvent(new Event("input"))}function debounce(e,t){let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>e.apply(this,r),t)}}document.getElementById("searchGeneral").addEventListener("input",debounce(filtrarGeneral,300)),document.getElementById("clearSearch").addEventListener("click",()=>{let e=document.getElementById("searchGeneral");e.value="",e.dispatchEvent(new Event("input"))}),window.buscarMarca=buscarMarca,document.getElementById("faqModal").addEventListener("hidden.bs.modal",()=>{document.querySelectorAll("#faqModal .accordion-collapse.show").forEach(e=>bootstrap.Collapse.getOrCreateInstance(e).hide())});
