fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQJ7PS8pvnCKdpLgJFonsZNN54Rs8oTpzGgCxhbfZzd3KmKb9k12OEwgAWuDAHiIPraWKxoS5TlCm4X/pub?gid=0&single=true&output=csv").then((e=>e.text())).then((e=>{const t=e.trim().split("\n");if(t.length>0){const e=t[0].split(",")[0].replace(",",".");document.getElementById("dolarValor").textContent=e||"N/A"}else document.getElementById("dolarValor").textContent="Sin datos"})).catch((e=>{document.getElementById("dolarValor").textContent="Error",console.error("Error al obtener d√≥lar:",e)}));const e=new Intl.DateTimeFormat("es-AR").format(new Date);document.getElementById("fechaActual").textContent=e,window.onload=function(){document.getElementById("logo-desktop").src="images/logo-miphone-1.svg?refresh="+(new Date).getTime()},Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vRr62BlKCzICpC0ctnU2mRB8cq_SOCcsgydXQJXD5pQvasO1b1iT0Wp_L7sFxH8UGJCepaMjng1GUO0/pub?gid=1610793698&single=true&output=csv",{download:!0,skipEmptyLines:!0,complete:function(e){const n=e.data,o=[];let s=null,r=!1;n.forEach((e=>{if(e[0]&&e.slice(1).every((e=>!e.trim())))s={nombre:e[0],headers:[],productos:[]},o.push(s),r=!0;else if(r&&s)s.headers=e,r=!1;else if(s&&e.length>0){for(;e.length<s.headers.length;)e.push("");s.productos.push(e)}})),function(e){const n=document.getElementById("categoriasContainer");n.innerHTML="",e.forEach(((e,o)=>{const s=`cat-${o}`,r=e.headers.indexOf("Ocultar"),l=t[e.nombre]||"bi bi-phone",d=document.createElement("div");d.className="accordion mb-1",d.innerHTML=`\n      <div class="accordion-flush">\n        <h2 class="accordion-header" id="heading-${s}">\n          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-${s}" aria-expanded="false" aria-controls="collapse-${s}">\n            <i class="${l} me-2"></i> ${e.nombre}\n          </button>\n        </h2>\n        <div id="collapse-${s}" class="accordion-collapse collapse" aria-labelledby="heading-${s}">\n          <div class="accordion-body">\n  ${function(e){const t={"MACBOOK AIR":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi√©n traemos iMac, Mac mini, Mac Studio","MACBOOK PRO":"Consultanos por versiones custom (Chip MAX, +RAM, etc). Tambi√©n traemos iMac, Mac mini, Mac Studio",IPHONE:"¬°Combo cargador original (Apple 20W, MWVV3AM) + U$30!",SAMSUNG:"Por otros productos de la marca (Linea Z, Samsung Tab, etc) consultanos por WhatsApp"};return t[e]?`\n    <div class="alert alert-warning d-flex align-items-center mb-3 py-2 px-3" role="alert">\n      <i class="bi bi-info-circle-fill me-2"></i>\n      <div class="small">${t[e]}</div>\n    </div>\n  `:""}(e.nombre)}\n            <div class="table-responsive">\n              <table class="table table-bordered table-sm text-center" id="tabla-${s}">\n                <thead class="table-light">\n                  <tr>\n                    ${e.headers.filter((e=>"Ocultar"!==e)).map((e=>`<th>${e}</th>`)).join("")}\n                  </tr>\n                </thead>\n                <tbody>\n                  ${e.productos.filter((e=>-1===r||"x"!==e[r].toLowerCase())).map((t=>t.every((e=>""===e))?`<tr><td colspan="${e.headers.length-(-1!==r?1:0)}">&nbsp;</td></tr>`:`\n  <tr>\n    ${t.map(((n,o)=>{if(o===r)return null;if("L"===e.headers[o]&&n){return`<td>${a[n]||n}</td>`}return`<td>${t.findIndex(((e,t)=>t!==r))===o?`<strong>${n}</strong>`:n||"&nbsp;"}</td>`})).filter((e=>null!==e)).join("")}\n  </tr>\n`)).join("")}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    `,n.appendChild(d)}))}(o)},error:function(e){console.error("Error al parsear CSV:",e)}});const t={IPHONE:"bi-apple",AIRPODS:"bi-earbuds","APPLE WATCH":"bi-smartwatch",AIRTAG:"bi-tag",IPAD:"bi-tablet-fill","MACBOOK AIR":"bi-laptop","MACBOOK PRO":"bi-laptop",PLAYSTATION:"bi-playstation",XBOX:"bi-xbox","NINTENDO SWITCH":"bi-nintendo-switch",VR:"bi-headset-vr",GOPRO:"bi-camera-video",INSTA360:"bi-camera-video",SMARTWATCH:"bi-watch",ACCESORIOS:"bi-bag-plus","DRONE DJI":"bi-robot"},a={NEW:'<span class="badge bg-warning text-dark">‚úàÔ∏è¬°NUEVO!</span>',SALE:'<span class="badge bg-danger text-white">üî•¬°OFERTA!</span>',HOT:'<span class="badge bg-primary">üî• HOT</span>',LIMITED:'<span class="badge bg-info text-dark">‚è≥ Edici√≥n limitada</span>'};document.getElementById("searchGeneral").addEventListener("input",function(e,t){let a;return(...n)=>{clearTimeout(a),a=setTimeout((()=>e.apply(this,n)),t)}}((()=>{const e=document.getElementById("searchGeneral").value.toLowerCase().trim(),t=e?e.split(/\s+/):[],a=document.getElementById("resultadoBusqueda");let n=0;document.querySelectorAll(".accordion-flush").forEach((a=>{const o=a.querySelector(".accordion-button"),s=a.querySelector(".collapse"),r=bootstrap.Collapse.getOrCreateInstance(s,{toggle:!1});if(!e)return a.style.display="",r.hide(),o.classList.add("collapsed"),o.setAttribute("aria-expanded","false"),void a.querySelectorAll("tbody tr").forEach((e=>{e.style.display=""}));const l=o.innerText.toLowerCase(),d=Array.from(a.querySelectorAll("tbody tr"));let i=!1;d.forEach((e=>{const a=Array.from(e.cells).filter(((e,t)=>2!==t)).map((e=>e.innerText)).join(" ").toLowerCase()+" "+l;if(e.innerText.trim()){const o=t.every((e=>a.includes(e)));e.style.display=o?"":"none",o&&(i=!0,n++)}else e.style.display="none"})),i?(a.style.display="",r.show(),o.classList.remove("collapsed"),o.setAttribute("aria-expanded","true")):(r.hide(),o.classList.add("collapsed"),o.setAttribute("aria-expanded","false"),a.style.display="none")})),e?0===n?(a.textContent="Sin resultados. Consultar existencia por WhatsApp",a.classList.add("no-resultado"),a.classList.remove("resultado-encontrado")):(a.textContent=`${n} resultado${1!==n?"s":""} encontrado${1!==n?"s":""}`,a.classList.add("resultado-encontrado"),a.classList.remove("no-resultado")):(a.textContent="",a.classList.remove("no-resultado","resultado-encontrado"))}),300)),document.getElementById("clearSearch").addEventListener("click",(function(){const e=document.getElementById("searchGeneral");e.value="",e.dispatchEvent(new Event("input"))})),document.getElementById("faqModal").addEventListener("hidden.bs.modal",(()=>{document.querySelectorAll("#faqModal .accordion-collapse.show").forEach((e=>{new bootstrap.Collapse(e,{toggle:!1}).hide()}))}));
